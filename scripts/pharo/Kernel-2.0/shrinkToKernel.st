!SmalltalkImage methodsFor: 'PharoKernel' stamp: 'PavelKrivanek 2/4/2012 19:49'!kernelPackageNames  ^ #('Announcements-Core' 'Announcements-Core' 'Collections-Abstract' 'Collections-Arithmetic' 'Collections-Arrayed' 'Collections-Atomic' 'Collections-Native' 'Collections-Sequenceable' 'Collections-Stack' 'Collections-Streams' 'Collections-Strings' 'Collections-Support' 'Collections-Text' 'Collections-Traits' 'Collections-Unordered' 'Collections-Weak' 'Compiler' 'Compression' 'Files' 'Graphics-Display Objects' 'Graphics-Primitives' 'Graphics-Transformations' 'Kernel' 'Multilingual-Encodings' 'Multilingual-ImmPlugin' 'Multilingual-Languages' 'Multilingual-TextConversion' 'Ring-Core-Kernel'  'Ring-Core-Containers' 'System-BreakPoints' 'System-Change Notification' 'System-Changes' 'System-CommandLine' 'System-Clipboard' 'System-Debugging' 'System-FileRegistry' 'System-Finalization' 'System-Localization' 'System-Object Events' 'System-Object Storage' 'System-Platforms' 'System-Support' 'Traits' 'UIManager' 'Transcript')! !BasicCodeLoaderTest removeFromSystem.CommandLineArgumentsTest removeFromSystem.CommandLineHandlerTest removeFromSystem.!!SmalltalkImage methodsFor: 'PharoKernel-private' stamp: 'PavelKrivanek 5/4/2012 11:18'!privShrinkingProcess  [    | packages |            10 timesRepeat: [      (Delay forMilliseconds: 100) wait.      Processor yield ].    Author fullName: 'Mr.Shrinker'.    self privCleanMonticello.    UIManager default: DummyUIManager new.    UIManager default progressBarEnabled: false.    self privCleanProcesses.    self privCleanGlobals.    5 timesRepeat: [Smalltalk garbageCollect].    DataStream initialize.    Beeper instVarNamed: #default put: nil.    Smalltalk cleanOutUndeclared.    5 timesRepeat: [Smalltalk garbageCollect].    Author reset.      KMPragmaKeymapBuilder uniqueInstance pragmaCollector announcer initialize.    self privShrinkUnicodeTables.    Display newDepth: 1.    self privCleanStartUpList.    self privCleanShutDownList."    CommandLine removeRegistrationNamed: #BasicCodeLoader.    SimpleCodeLoader register."    "move class Model to different category"    Object subclass: #Model instanceVariableNames: 'dependents' classVariableNames: '' poolDictionaries: '' category: 'Kernel-Objects'.    self privCleanTextConstants.    SoundService default: nil.    SoundService unregister: DummySoundSystem.    ThreadSafeTranscript install.    self privCleanUnloadMethods.    SystemNavigation default removeAllButPackages: self kernelPackageNames.    Smalltalk flushClassNameCache.    3 timesRepeat: [      Smalltalk garbageCollect.        Symbol compactSymbolTable.].    Undeclared removeUnreferencedKeys.    self privRecompileAll.        self privCleanChangeSets.        SystemEventManager allInstances do: [:i | i instVarNamed: #actionMap put: IdentityDictionary new].    FileServices removeObsolete.    DebuggerMethodMap voidMapCache.    Object flushEvents.    DataStream initialize.    Locale classPool at: #LocaleChangeListeners put: nil.    SmalltalkImage classPool at: #Tools put: nil.    Behavior flushObsoleteSubclasses.    Smalltalk flushClassNameCache.    Smalltalk organization removeEmptyCategories.    WeakArray restartFinalizationProcess.    "UIManager default progressBarEnabled: true."    "Smalltalk condenseChanges."    Smalltalk saveImageInNewContext.  ] ifError: [:e |    | rep |    rep := FileStream forceNewFileNamed: 'PharoDebug.log'.    rep nextPutAll: 'PharoKernel shrinking report'; cr.    rep nextPutAll: 'Error:'; cr.    rep nextPutAll: e asString; cr.    rep nextPutAll: thisContext stack size asString.    thisContext stack copy withIndexDo: [:stck :i |    [ rep nextPutAll: i asString; space; nextPutAll: stck asString; cr] ifError: []].    rep close.     Smalltalk quitPrimitive ] ! !Smalltalk shrinkToKernel.