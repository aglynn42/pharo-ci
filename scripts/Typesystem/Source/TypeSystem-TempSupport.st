PPBaseSmalltalkGrammar subclass: #PPTypeGrammar	instanceVariableNames: 'selfType dynType nominalClassType nominalType basicType methodSignatures unaryType selector parenType methodSignature nominalIdentifier type multipleKeywordToken lambdaType complexType lambdaSpecialToken'	classVariableNames: ''	poolDictionaries: ''	category: 'TypeSystem-TempSupport'!!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:19'!basicType	^ selfType / dynType / nominalClassType / nominalType! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:26'!complexType	^ basicType optional , ${ asParser smalltalkToken , methodSignatures , $} asParser smalltalkToken! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:26'!dynType	^ $? asParser smalltalkToken! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:35'!lambdaSpecialToken	^ (Unicode charFromUnicode: 8594) asParser! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:35'!lambdaType	^ unaryType star , ('->' asParser / lambdaSpecialToken) smalltalkToken , unaryType! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:27'!methodSignature	^ selector , parenType! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/16/2011 17:02'!methodSignatures	^ ((methodSignature , $. asParser smalltalkToken) star , methodSignature) ==> [:nodes| (nodes first collect: [:each|each first]) asOrderedCollection addLast: nodes second; yourself]! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:28'!multipleKeywordToken	^keywordToken plus ==> [:tokens| PPSpecialSmalltalkToken on: tokens "PPSmalltalkToken on: (token inject: '' into: [:res :each| res, each value trimBoth])"]! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/15/2011 19:04'!nominalClassType	^ (nominalIdentifier , 'class' asParser) smalltalkToken ! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:29'!nominalIdentifier	^ (#uppercase asParser , #word asParser star) smalltalkToken! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:29'!nominalType	^ nominalIdentifier! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:29'!parenType	^ $( asParser smalltalkToken , type , $) asParser smalltalkToken! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:30'!selector	^ multipleKeywordToken / unaryToken / binaryToken! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:30'!selfType	^ 'Self' asParser smalltalkToken, ('class' asParser / 'instance' asParser) smalltalkToken optional! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:30'!type	^ lambdaType / complexType / basicType! !!PPTypeGrammar methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 00:31'!unaryType	^ basicType / parenType! !PPTypeGrammar subclass: #PPTypeParser	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'TypeSystem-TempSupport'!!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/12/2011 12:24'!complexType	^ super complexType		==> [:nodes | StructuralType new base: (nodes first ifNil: [Object asType]);				 methods: nodes third]! !!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 11:47'!dynType	^ super dynType		==> [:nodes | DynType explicitInstance]! !!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 11:48'!lambdaType	^ super lambdaType		==> [:nodes | 			| ltype |			ltype := LambdaType new.			ltype params: nodes first.			ltype return: nodes last.]! !!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/12/2011 12:28'!methodSignature	^ super methodSignature		==> [:nodes | MethodSignature new selector: (nodes first) value asSymbol; signature: nodes last]! !!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 11:38'!nominalClassType	^ super nominalClassType		==> [:token | NominalType named: token value]! !!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 11:34'!nominalType	^ super nominalType		==> [:token | NominalType named: token value]! !!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/12/2011 12:28'!parenType	^super parenType ==>[:nodes| nodes second]! !!PPTypeParser methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/5/2011 11:40'!selfType	^ super selfType		==> [:token | SelfType new kind: (token second ifNil: [#normal] ifNotNil: [token second value asSymbol])]! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!PPTypeParser class	instanceVariableNames: ''!!PPTypeParser class methodsFor: 'as yet unclassified' stamp: 'EstebanAllende 12/16/2011 17:04'!initialize	TypeConfiguration uniqueInstance bootstrap ifFalse: [^self].	PPTypedSmalltalkGrammar typeGrammar: self new type.	PPTypedSmalltalkParser typeGrammar: self new type.	PPTypedSmalltalkParser typeParser: self new type.! !PPTypeParser initialize!